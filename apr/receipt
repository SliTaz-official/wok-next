# SliTaz package receipt v2.

PACKAGE="apr"
VERSION="1.6.5"
CATEGORY="misc"
SHORT_DESC="Apache Portable Runtime Library"
MAINTAINER="devel@slitaz.org"
LICENSE="Apache"
WEB_SITE="http://apr.apache.org/"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/general/apr.html"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="https://archive.apache.org/dist/apr/$TARBALL"

BUILD_DEPENDS="util-linux-uuid-dev"
SPLIT="$PACKAGE-dev"

COOKOPTS="skip-log-errors force-arch" # different apr-1-config, .h, .pc, .mk, libtool

compile_rules() {
	# should define prefix
	./configure \
		--prefix=/usr \
		--disable-static \
		--with-installbuilddir=/usr/share/apr-1/build \
		--enable-nonportable-atomics \
		--with-devrandom \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install
}

genpkg_rules() {
	case $PACKAGE in
		apr)
			copy *.so*
			DEPENDS="util-linux-uuid"
			;;
		apr-dev)
			copy @dev build/ *.exp
			DEPENDS="apr util-linux-uuid-dev"
			;;
	esac
}
