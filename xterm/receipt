# SliTaz package receipt v2.

PACKAGE="xterm"
VERSION="330"
CATEGORY="utilities"
SHORT_DESC="X terminal emulator"
MAINTAINER="devel@slitaz.org"
LICENSE="MIT"
WEB_SITE="http://invisible-island.net/xterm/"
COOKOPTS="!pixmaps"

TARBALL="$PACKAGE-$VERSION.tgz"
WGET_URL="ftp://ftp.invisible-island.net/xterm/$TARBALL"

BUILD_DEPENDS="ncurses-dev xorg-libXpm-dev xorg-libXinerama-dev \
xorg-libXaw3d-dev xorg-libXcursor-dev freetype-dev expat-dev fontconfig-dev \
xorg-libXft-dev xorg-libXt-dev"

compile_rules() {
	export LDFLAGS="$LDFLAGS -Wl,--copy-dt-needed-entries"
	./configure \
		--with-icon-symlink \
		--disable-desktop \
		--with-x \
		--with-Xaw3d \
		--with-app-defaults=/usr/share/X11/app-defaults \
		--enable-wide-chars \
		--enable-freetype \
		--enable-doublechars \
		--enable-256-color \
		--enable-meta-sends-esc \
		--disable-delete-is-del \
		--disable-sun-fkeys \
		--disable-boxchars \
		--disable-tek4014 \
		--disable-vt52 \
		--disable-luit \
		--enable-sixel-graphics \
		--disable-rectangles \
		$CONFIGURE_ARGS &&
	make &&
	make DESTDIR=$install install || return 1

	cat >> $install/usr/share/X11/app-defaults/XTerm <<EOT
!
!	libXaw3d  options
xterm*beNiceToColormap: false
xterm*SmeBSB.shadowWidth:  3
xterm*topShadowContrast: 20
xterm*bottomShadowContrast: 50
EOT

	for size in 16 48; do
		dir=$install/usr/share/icons/hicolor/${size}x$size/apps
		mkdir -p $dir
		cp $src/icons/mini.xterm_${size}x$size.png $dir/xterm.png
	done
}

# One of the first X apps cross compiled. Be sure all went well
testsuite() {
	readelf -h $install/usr/bin/xterm
}

genpkg_rules() {
	copy xterm resize XTerm XTerm-color *.png
	TAGS="terminal"
	DEPENDS="fontconfig ncurses xorg-libICE xorg-libX11 xorg-libXaw3d \
	xorg-libXft xorg-libXinerama xorg-libXmu xorg-libXpm xorg-libXt"
}
