# SliTaz package receipt v2.

PACKAGE="mc"
VERSION="4.8.19"
CATEGORY="system-tools"
SHORT_DESC="Midnight Commander - ncurses based file manager"
MAINTAINER="erjo@slitaz.org"
LICENSE="GPL3"
WEB_SITE="http://midnight-commander.org/"

TARBALL="$PACKAGE-$VERSION.tar.xz"
WGET_URL="http://ftp.midnight-commander.org/$TARBALL"

BUILD_DEPENDS="gpm-dev glib-dev ncurses-dev util-linux-mount-dev \
util-linux-blkid-dev util-linux-uuid-dev check-dev gettext libssh2-dev"

COOKOPTS="!menus"

compile_rules() {
	sed -i 's/lzma -cd/lzcat/' $src/src/editor/edit.c

	./configure \
		--enable-charset \
		--with-gpm-mouse \
		--with-screen=ncurses \
		$CONFIGURE_ARGS &&
	make &&
	make install

	mkdir -p $install/usr/share/terminfo/s
	cp -a /usr/share/terminfo/s/screen-256color $install/usr/share/terminfo/s

	mkdir -p $install/usr/share/applications
	cp $stuff/*.desktop $install/usr/share/applications

	install -m755 $stuff/mc.sh $install/usr/bin

	chown -R root:root $install
}

genpkg_rules() {
	copy bin/ mc/ terminfo/ applications/

	sed -i 's#|profile|#&receipt|#' $fs/usr/share/mc/syntax/Syntax
	sed -i 's/lzma -dc/lzcat/g'     $fs/usr/libexec/mc/ext.d/archive.sh
	DEPENDS="ncurses glib e2fsprogs util-linux-blkid libssh2 openssl zlib pcre"
	SUGGESTED="gpm xz cdrkit-isoinfo lynx w3m wv poppler-apps file"
	TAGS="file-manager text-editor"
}
