# SliTaz package receipt v2.

PACKAGE="tiff"
VERSION="4.0.9"
CATEGORY="graphics"
SHORT_DESC="TIFF images"
MAINTAINER="devel@slitaz.org"
LICENSE="MIT"
WEB_SITE="http://www.libtiff.org/"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/general/libtiff.html"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="http://download.osgeo.org/libtiff/$TARBALL"

BUILD_DEPENDS="cmake ninja zlib-dev libjpeg-turbo-dev xz-dev \
mesa-dev glu-dev freeglut-dev"
SPLIT="$PACKAGE-apps $PACKAGE-dev $PACKAGE-gl:gl $PACKAGE-gl-apps:gl \
$PACKAGE-gl-dev:gl"

compile_rules() {
	case $SET in
		# no options for it
		'') sed -i 's|HAVE_OPENGL TRUE|HAVE_OPENGL FALSE|' CMakeLists.txt;;
	esac

	mkdir -p libtiff-build
	cd       libtiff-build

	cmake \
		-DCMAKE_INSTALL_DOCDIR=/usr/share/doc/libtiff-$VERSION \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-G Ninja \
		.. &&
	ninja &&
	ninja install
}

genpkg_rules() {
	case $PACKAGE in
		tiff)
			copy *.so*
			CAT="graphics|libraries"
			DEPENDS="libjpeg-turbo liblzma zlib"
			;;
		tiff-apps)
			copy bin/
			CAT="graphics|CLI applications"
			DEPENDS="tiff"
			;;
		tiff-dev)
			copy @dev
			DEPENDS="tiff tiff-apps"
			;;

		tiff-gl)
			copy *.so*
			CAT="graphics|libraries"
			DEPENDS="libjpeg-turbo liblzma zlib"
			PROVIDE="tiff:mesa"
			;;
		tiff-gl-apps)
			copy bin/
			CAT="graphics|CLI applications"
			DEPENDS="freeglut mesa tiff"
			PROVIDE="tiff-apps:mesa"
			;;
		tiff-gl-dev)
			copy @dev
			DEPENDS="tiff-gl tiff-gl-apps"
			PROVIDE="tiff-dev:mesa"
			;;
	esac
}
