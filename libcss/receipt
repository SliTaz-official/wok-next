# SliTaz package receipt v2.

PACKAGE="libcss"
COMMIT="3e58dd9a29a10cd6400031f0b510084ffacc41d0"
VERSION="0.6.1-170920"
CATEGORY="system-tools"
SHORT_DESC="CSS parser and selection engine"
MAINTAINER="erjo@slitaz.org"
LICENSE="MIT"
WEB_SITE="http://www.netsurf-browser.org/projects/libcss/"

TARBALL="$PACKAGE-${COMMIT:-$VERSION}.tar.bz2"
BASE_URL="http://source.netsurf-browser.org/$PACKAGE.git/snapshot"
if [ -n "$COMMIT" ]; then
	WGET_URL="$BASE_URL/$PACKAGE-$COMMIT.tar.bz2"
else
	WGET_URL="$BASE_URL/release/$VERSION.tar.bz2"
fi

BUILD_DEPENDS="netsurf-buildsystem libwapcaplet-dev libparserutils-dev"
SPLIT="libcss-dev"

compile_rules() {
	[ -z "$COMMIT" ] && cd $VERSION

	sed -i 's|_BSD_SOURCE|_DEFAULT_SOURCE|' Makefile
	export CFLAGS="-Wno-error=unused-but-set-variable"

	make \
		PREFIX=/usr \
		LIBDIR=lib \
		INCLUDEDIR=include \
		COMPONENT_TYPE=lib-shared \
		install
}

genpkg_rules() {
	case $PACKAGE in
		libcss)
			copy @std
			DEPENDS="libparserutils libwapcaplet"
			;;
		*-dev)
			copy @dev
			DEPENDS="libcss libparserutils-dev libwapcaplet-dev"
			;;
	esac
}
