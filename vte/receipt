# SliTaz package receipt v2.

PACKAGE="vte"
VERSION="0.46.1"
CATEGORY="utilities"
SHORT_DESC="Terminal capabilities for GTK+ widgets"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://www.gnome.org/"
HOST_ARCH="i486 arm"

TARBALL="$PACKAGE-$VERSION.tar.xz"
WGET_URL="$GNOME_MIRROR/$PACKAGE/${VERSION%.*}/$TARBALL"

BUILD_DEPENDS="pygtk-dev python-dev gobject-introspection-dev perl \
perl-xml-parser ncurses-dev"
BUILD_DEPENDS_arm="gtk+-dev ncurses-dev"
SPLIT="vte-terminal python-vte vte-dev"

BUILD_DEPENDS="automake gettext gobject-introspection-dev vala intltool \
pango-dev gtk+3-dev pcre2-dev gnutls-dev"

# Handle cross compilation.
case "$ARCH" in
	i?86) ARCH_ARGS="--enable-introspection=yes";;
	arm)  ARCH_ARGS="--enable-introspection=no";;
esac

# Rules to configure and make the package.
compile_rules()
{
	# http://www.linuxfromscratch.org/blfs/view/stable/gnome/vte.html
	sed -i '/Werror/d' configure.ac &&
	autoreconf &&

	./configure \
		--sysconfdir=/etc \
		--disable-static \
		$CONFIGURE_ARGS $ARCH_ARGS &&
	make -j1 && make install

	# add 'Home' and 'End' keys
	#sed -i '9i\ \ \ \ :kh=\\E[H:@7=\\E[F:\\' $install/usr/share/vte/termcap-0.0/xterm
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	case $PACKAGE in
		vte)
			copy @std
			DEPENDS="gtk+ ncurses xorg-libXdamage"
			;;
		vte-terminal)
			copy bin/
			CAT="development|X Terminal"
			DEPENDS="expat vte"
			;;
		python-vte)
			copy python*/ pygtk/
			CAT="development|terminal capabilities for GTK+ widgets"
			DEPENDS="vte"
			;;
		vte-dev) copy @dev;;
	esac
}
