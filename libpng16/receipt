# SliTaz package receipt v2.

PACKAGE="libpng16"
VERSION="1.6.35"
CATEGORY="libs"
SHORT_DESC="PNG images library 1.6 series with APNG support"
MAINTAINER="al.bobylev@gmail.com"
LICENSE="zlib/libpng"
WEB_SITE="http://www.libpng.org/pub/png/libpng.html"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/general/libpng.html"
REPOLOGY="libpng"

TARBALL="libpng-$VERSION.tar.xz"
WGET_URL="$SF_MIRROR/libpng/$TARBALL"

BUILD_DEPENDS="zlib-dev"
SPLIT="$PACKAGE-dev"

compile_rules() {
	# don't use --disable-static: optipng-static require such lib

	LIBS=-lpthread \
	./configure \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install || return 1

	cook_pick_docs README libpng-manual.txt

	# Misc png tools
	cd contrib/pngminus
	make PNGLIB="-L$install/usr/lib -lpng" -f makefile.std png2pnm pnm2png
	cp -a png2pnm pnm2png $install/usr/bin
}

genpkg_rules() {
	case $PACKAGE in
		libpng16)
			copy @std
			DEPENDS="zlib"
			;;
		*-dev)
			copy @dev
			DEPENDS="libpng16 zlib-dev"
			;;
	esac
}
