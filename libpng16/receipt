# SliTaz package receipt v2.

PACKAGE="libpng16"
VERSION="1.6.28"
CATEGORY="libs"
SHORT_DESC="PNG images library 1.6 series with APNG support"
MAINTAINER="al.bobylev@gmail.com"
LICENSE="zlib/libpng"
WEB_SITE="http://www.libpng.org/pub/png/libpng.html"
HOST_ARCH="i486 arm"

TARBALL="libpng-$VERSION.tar.xz"
WGET_URL="$SF_MIRROR/libpng/$TARBALL"

BUILD_DEPENDS="gawk zlib-dev"
SPLIT="libpng16-dev"

# Rules to configure and make the package.
compile_rules()
{
	LIBS=-lpthread \
	./configure \
		--disable-static \
		$CONFIGURE_ARGS &&
	make && make install &&

	docdir=$install/usr/share/doc/libpng-$VERSION &&
	mkdir -p $docdir &&
	cp -v README libpng-manual.txt $docdir

	# Misc png tools
	cd contrib/pngminus
	make PNGLIB="-L$DESTDIR/usr/lib -lpng" -f makefile.std png2pnm pnm2png
	cp -a png2pnm pnm2png $DESTDIR/usr/bin
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	case $PACKAGE in
		libpng16)
			copy @std
			DEPENDS="zlib"
			PROVIDE="libpng"
			;;
		libpng16-dev)
			copy @dev
			DEPENDS="zlib-dev pkg-config"
			PROVIDE="libpng-dev"
			;;
	esac
}
