# SliTaz package receipt v2.

PACKAGE="volume_key"
VERSION="0.3.11"
CATEGORY="libs"
SHORT_DESC="Manipulating storage volume encryption keys"
MAINTAINER="al.bobylev@gmail.com"
LICENSE="GPL2"
WEB_SITE="https://pagure.io/volume_key"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/postlfs/volume_key.html"
REPOLOGY="volume-key"

TARBALL="$PACKAGE-$VERSION.tar.xz"
WGET_URL="https://releases.pagure.org/volume_key/$TARBALL"

BUILD_DEPENDS="automake gettext-dev gpgme-dev libtool cryptsetup-dev nss-dev \
python3-dev util-linux-blkid-dev glib-dev"
SPLIT="$PACKAGE-python $PACKAGE $PACKAGE-dev"

compile_rules() {
	sed -i '/config.h/d' lib/libvolume_key.h
	autoreconf -fiv &&

	./configure $CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install
}

genpkg_rules() {
	case $PACKAGE in
		*-python)
			copy python3.*/
			find $fs -name '*.la' -delete
			CAT="libs|python 3 bindings"
			DEPENDS="glib nss python3 volume_key"
			;;
		volume_key)
			copy @std @rm
			DEPENDS="cryptsetup glib gpgme nspr nss util-linux-blkid \
			   libassuan libdevmapper libgcrypt libgpg-error"
			;;
		*-dev)
			copy @dev
			;;
	esac
}
