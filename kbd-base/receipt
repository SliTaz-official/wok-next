# SliTaz package receipt.

PACKAGE="kbd-base"
VERSION="2.0.3"
CATEGORY="base-system"
SHORT_DESC="Keyboard mapping definitions, loadkeys and setfont utilities"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://kbd-project.org/"
HOST_ARCH="i486 arm"

WANTED="kbd"
DEPENDS="kbd"

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	cook_copy_files loadkeys setfont \
		\
		be-latin1.map* fr-latin1.map* dvorak.map* dvorak-r.map* dvorak-l.map* \
		br-abnt2.map* cf.map* cz-lat2.map* dk-latin1.map* es.map* fi.map* \
		gr.map* gr-pc.map* it.map* is-latin1.map* jp106.map* nl2.map* \
		no-latin1.map* pl2.map* pt-latin1.map* ru.map* se-lat6.map* \
		tr_q-latin5.map* trq.map* uk.map* us-acentos.map* us.map* croat.map* \
		de_CH-latin1.map* de-latin1.map* fr_CH-latin1.map* hu.map* \
		sg-latin1.map* slovene.map* \
		\
		azerty-layout.inc compose.inc euro1.inc euro1.map.gz euro2.map.gz \
		linux-keys-bare.inc linux-with-alt-and-altgr.inc \
		linux-with-two-alt-keys.inc qwerty-layout.inc qwertz-layout.inc \
		compose.latin1
	rm -rf $fs/usr/share/kbd/keymaps/i386/olpc

	# X11 keyboard aliases
	ln -s croat.map.gz $fs/usr/share/kbd/keymaps/i386/qwertz/hr.map.gz
}

# Make sure it will run on host or no keyboard support...
testsuite()
{
	readelf -h $install/usr/bin/loadkeys
	readelf -h $install/usr/bin/setfont
}

# Overlap busybox
pre_install()
{
	for i in deallocvt chvt setkeycodes openvt kbd_mode; do
		rm -f $1/usr/bin/$i
	done
}

post_remove()
{
	for i in deallocvt chvt setkeycodes openvt kbd_mode; do
		ln -s /bin/busybox $1/usr/bin/$i
	done
}
