# SliTaz package receipt v2.

PACKAGE="harfbuzz"
VERSION="1.4.2"
CATEGORY="system-tools"
SHORT_DESC="OpenType text shaping engine"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="https://www.freedesktop.org/wiki/Software/HarfBuzz/"
HOST_ARCH="i486 arm"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="https://www.freedesktop.org/software/harfbuzz/release/$TARBALL"

BUILD_DEPENDS="glib-dev cairo-dev freetype-dev fontconfig-dev icu-dev"
SPLIT="libharfbuzz libharfbuzz-icu harfbuzz-icu-dev harfbuzz-dev"

# Rules to configure and make the package.
compile_rules()
{
	./configure \
		--with-glib \
		--with-freetype \
		--with-gobject \
		$CONFIGURE_ARGS &&
	make && make install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	# Note, we have two development packages:
	#   * harfbuzz-dev     - without ICU integration
	#   * harfbuzz-icu-dev - with    ICU integration
	# Use one of these packages at a time in your receipt.

	case $PACKAGE in
		harfbuzz)
			copy bin/
			CAT="system-tools|applications"
			DEPENDS="libharfbuzz cairo"
			;;
		libharfbuzz)
			copy libharfbuzz.so* libharfbuzz-gobject.so*
			CAT="libs|shared library"
			DEPENDS="freetype glib"
			;;
		libharfbuzz-icu)
			copy libharfbuzz-icu.so*
			CAT="libs|ICU integration"
			DEPENDS="libicu libharfbuzz"
			;;
		harfbuzz-icu-dev)
			copy *-icu.h *-icu.la *-icu.pc
			CAT="development|ICU integration development files"
			DEPENDS="libharfbuzz-icu harfbuzz-dev icu-dev"
			PROVIDE="harfbuzz-icu" # fake for cookutils as it always wanted to install package without '-dev'
			;;
		harfbuzz-dev)
			copy @dev
			remove_already_packed
			DEPENDS="harfbuzz bzip2-dev freetype-dev glib-dev libffi-dev \
			libpng16-dev pcre-dev"
			;;
	esac
}
