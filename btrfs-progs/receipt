# SliTaz package receipt v2.

PACKAGE="btrfs-progs"
VERSION="4.9.1"
CATEGORY="system-tools"
SHORT_DESC="Btrfs Filesystem"
MAINTAINER="pascal.bellard@slitaz.org"
LICENSE="GPL2"
WEB_SITE="https://btrfs.wiki.kernel.org/index.php/Main_Page"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://git.kernel.org/pub/scm/linux/kernel/git/kdave/btrfs-progs.git/snapshot/$TARBALL"

BUILD_DEPENDS="util-linux-uuid-dev e2fsprogs e2fsprogs-dev zlib-dev acl-dev \
util-linux-blkid-dev lzo-dev autoconf automake"
SPLIT="btrfs-libs btrfs-mkfs btrfs-dev"

# Rules to configure and make the package.
compile_rules()
{
	./autogen.sh
	./configure \
		--prefix=/usr \
		--sysconfdir=/etc \
		--disable-documentation \
		$CONFIGURE_ARGS &&
	make &&
	make DESTDIR=$DESTDIR prefix=/usr -j1 install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	case $PACKAGE in
		btrfs-progs)
			copy bin/
			rm $fs/usr/bin/mkfs.btrfs
			TAGS="filesystem fault-tolerance"
			PROVIDE="btrfs-tools"
			DEPENDS="e2fsprogs libcomerr lzo util-linux-blkid util-linux-uuid \
			zlib    acl btrfs-mkfs"
			;;
		btrfs-libs)
			copy *.so*
			CATEGORY="system-tools|library"
			DEPENDS="lzo util-linux-blkid util-linux-uuid zlib"
			;;
		btrfs-mkfs)
			copy mkfs.btrfs
			CAT="system-tools|creation tool"
			DEPENDS="lzo util-linux-blkid util-linux-uuid zlib"
			;;
		*-dev) copy @dev;;
	esac
}
