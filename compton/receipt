# SliTaz package receipt v2.

PACKAGE="compton"
VERSION="0.1_beta2+87" # 87 commits to master since release 0.1_beta2
COMMIT="316eac0"
CATEGORY="x-window"
SHORT_DESC="A compositor for X"
MAINTAINER="pankso@slitaz.org"
LICENSE="MIT"
WEB_SITE="https://github.com/chjj/compton"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://github.com/chjj/compton/archive/${COMMIT:-v$VERSION}.tar.gz"

BUILD_DEPENDS="pcre-dev xorg-libX11-dev xorg-libXcomposite-dev \
xorg-libXfixes-dev xorg-libXdamage-dev xorg-libXrender-dev xorg-libXext-dev \
xorg-libXrandr-dev xorg-libXinerama-dev dbus-dev asciidoc libxml2-tools \
docbook-xsl libconfig-dev"
# Optional bdeps: libconfig-dev libdrm-dev mesa-dev

compile_rules() {
	make \
		COMPTON_VERSION=v$VERSION \
		NO_VSYNC_DRM=yes \
		NO_VSYNC_OPENGL=yes \
		PREFIX=/usr \
		DOCDIR=/usr/share/doc/$PACKAGE-$VERSION \
		install || return 1

	mkdir -p $install/etc/xdg/compton
	cp $src/compton.sample.conf $install/etc/xdg/compton/compton.conf
	cp -r $stuff/autostart $install/etc/xdg/
}

genpkg_rules() {
	copy etc/ bin/	# skip icons
	DEPENDS="dbus libconfig libpcre xorg-libX11 xorg-libXcomposite \
	xorg-libXdamage xorg-libXext xorg-libXfixes xorg-libXinerama \
	xorg-libXrandr xorg-libXrender   xorg-xwininfo xorg-xprop libconfig"
	CONFIG_FILES="/etc/xdg/compton/compton.conf"
}
