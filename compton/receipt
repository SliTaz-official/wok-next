# SliTaz package receipt v2.

PACKAGE="compton"
VERSION="0.1_beta2+87" # 87 commits to master since release 0.1_beta2
COMMIT="316eac0"
CATEGORY="x-window"
SHORT_DESC="A compositor for X"
MAINTAINER="pankso@slitaz.org"
LICENSE="MIT"
WEB_SITE="https://github.com/chjj/compton"
HOST_ARCH="i486 arm"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://github.com/chjj/compton/archive/${COMMIT:-v$VERSION}.tar.gz"

BUILD_DEPENDS="pcre-dev xorg-libX11-dev xorg-libXcomposite-dev \
xorg-libXfixes-dev xorg-libXdamage-dev xorg-libXrender-dev xorg-libXext-dev \
xorg-libXrandr-dev xorg-libXinerama-dev dbus-dev asciidoc libxml2-tools \
docbook-xsl"
# Optional bdeps: libconfig-dev libdrm-dev mesa-dev

# Rules to configure and make the package.
compile_rules()
{
	make \
		COMPTON_VERSION=v$VERSION \
		NO_LIBCONFIG=yes \
		NO_VSYNC_DRM=yes \
		NO_VSYNC_OPENGL=yes \
		PREFIX=/usr \
		DOCDIR=/usr/share/doc/$PACKAGE-$VERSION \
		install || return 1

	mkdir -p $install/etc/xdg/compton
	cp $src/compton.sample.conf $install/etc/xdg/compton/compton.conf
	cp -r $stuff/autostart $install/etc/xdg/
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	copy etc/ bin/	# skip icons
	DEPENDS="dbus pcre xorg-libX11 xorg-libXcomposite xorg-libXdamage \
	xorg-libXext xorg-libXfixes xorg-libXinerama xorg-libXrandr \
	xorg-libXrender   xorg-xwininfo xorg-xprop"
	CONFIG_FILES="/etc/xdg/compton/compton.conf"
}
