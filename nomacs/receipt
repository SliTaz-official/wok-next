# SliTaz package receipt.

PACKAGE="nomacs"
VERSION="2.4.6"
CATEGORY="graphics"
SHORT_DESC="Pictures browser"
MAINTAINER="psychomaniak@xakep.ru"
LICENSE="GPL3"
WEB_SITE="http://www.nomacs.org"
TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://github.com/nomacs/nomacs/archive/$VERSION.tar.gz"

DEPENDS="libQtCore libQtGui libQtNetwork libgomp exiv2"
BUILD_DEPENDS="Qt4-dev qmake cmake exiv2-dev libraw-dev zlib-dev expat-dev"
SUGGESTED="xdg-utils qtconfig"

# Rules to configure and make the package.
compile_rules()
{
	cd $src/ImageLounge/src/img
	cp -f nomacs32.png nomacs.png
	cd $src/ImageLounge ; sed -i 's/ ON/ OFF/g' CMakeLists.txt
	mkdir build ; cd build
	cmake \
		-DENABLE_OPENCV=OFF \
		-DENABLE_RAW=OFF \
		-DENABLE_WEBP=OFF \
		-DENABLE_TIFF=OFF \
		-DDISABLE_QT_DEBUG=ON \
		-DCMAKE_INSTALL_PREFIX=/usr ..
	make
	make DESTDIR=$DESTDIR install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	cp -a $install/* $fs
	rm -rf $src/build
	cd $fs/usr/share/$PACKAGE/translations
	find * -size -62k -delete
}
