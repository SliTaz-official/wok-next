# SliTaz package receipt v2.

PACKAGE="luafilesystem"
VERSION="1.6.3"
CATEGORY="libdevel"
SHORT_DESC="File system library for the Lua programming language"
MAINTAINER="pascal.bellard@slitaz.org"
LICENSE="MIT"
WEB_SITE="http://keplerproject.github.io/luafilesystem/"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://github.com/keplerproject/$PACKAGE/archive/v${VERSION//./_}.tar.gz"

BUILD_DEPENDS="lua-dev"

compile_rules() {
	# Determine Lua version (i.e "5.3")
	luaver=$(grep 'V=' /usr/lib/pkgconfig/lua.pc | cut -d= -f2)
	# Fix prefix and install dir
	sed -i "s|^PREFIX=.*|PREFIX=/usr|; s|5.1|$luaver|" $src/config
	# Use DESTDIR
	sed -i "s|\$(LUA_LIBDIR)|\$(DESTDIR)&|" $src/Makefile

	make &&
	make test &&
	make install
}

genpkg_rules() {
	copy @std
	SUGGESTED="lua"
}
