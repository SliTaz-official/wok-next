# SliTaz package receipt v2.

PACKAGE="libextractor"
VERSION="1.6"
CATEGORY="utilities"
SHORT_DESC="Extract meta data from files of arbitrary type"
MAINTAINER="pascal.bellard@slitaz.org"
LICENSE="GPL2"
WEB_SITE="https://www.gnu.org/software/libextractor/"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="$GNU_MIRROR/$PACKAGE/$TARBALL"

BUILD_DEPENDS="libtool   iso-codes libvorbis-dev flac-dev zlib-dev bzip2-dev \
libmpeg2-dev libjpeg-turbo-dev tiff-dev libarchive-dev exiv2-dev giflib-dev \
libmagic-dev tidy-dev gettext glib-dev gdk-pixbuf-dev libgsf-dev ffmpeg-dev"
SPLIT="libextractor-archive libextractor-exiv2 libextractor-flac \
libextractor-gif libextractor-jpeg libextractor-mime libextractor-mpeg \
libextractor-ogg libextractor-ole2 libextractor-thumbnailffmpeg \
libextractor-thumbnailgtk libextractor-tiff libextractor libextractor-dev"

compile_rules() {
	./configure \
		--enable-shared \
		--disable-static \
	$CONFIGURE_ARGS &&
	make -j 1 &&
	make  install
}

genpkg_rules() {
	case $PACKAGE in
		libextractor)
			copy @std @rm
			DEPENDS="bzlib libltdl zlib"
			;;
		*-dev)
			copy @dev
			DEPENDS="${SPLIT/$PACKAGE/} acl-dev attr-dev bzip2-dev curl-dev \
			exiv2-dev expat-dev ffmpeg-dev flac-dev gdk-pixbuf-dev giflib-dev \
			glib-dev libjpeg-turbo-dev libarchive-dev libffi-dev libgsf-dev \
			libidn2-dev libmagic-dev libmpeg2-dev libogg-dev libpng16-dev \
			libssh2-dev libtool libvorbis-dev libxml2-dev lz4-lib lzo-dev \
			nettle-dev openssl-dev pcre-dev tiff-dev util-linux-blkid-dev \
			util-linux-mount-dev util-linux-uuid-dev xz-dev zlib-dev"
			;;
		*)
			copy libextractor_${PACKAGE/libextractor-/}.so
			CAT="utilities|${PACKAGE/libextractor-/} plugin"
			;;
	esac

	case $PACKAGE in
		*-archive) DEPENDS="libarchive";;
		*-exiv2)   DEPENDS="exiv2";;
		*-flac)    DEPENDS="flac";;
		*-gif)     DEPENDS="giflib";;
		*-jpeg)    DEPENDS="libjpeg-turbo";;
		*-mime)    DEPENDS="libmagic";;
		*-mpeg)    DEPENDS="libmpeg2";;
		*-ogg)     DEPENDS="libogg libvorbis";;
		*-ole2)    DEPENDS="glib libextractor libgsf libxml2";;
		*ffmpeg)   DEPENDS="ffmpeg libmagic";;
		*gtk)      DEPENDS="gdk-pixbuf glib libmagic";;
		*-tiff)    DEPENDS="tiff";;
	esac
}
