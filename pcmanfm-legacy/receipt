# SliTaz package receipt v2.

PACKAGE="pcmanfm-legacy"
VERSION="0.5.2"
SOURCE="pcmanfm"
CATEGORY="system-tools"
SHORT_DESC="Light and easy to use file manager"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://pcmanfm.sourceforge.net/"

TARBALL="$SOURCE-$VERSION.tar.bz2"
WGET_URL="$SF_MIRROR/$SOURCE/$TARBALL"

BUILD_DEPENDS="gtk+-dev gamin-dev gamin shared-mime-info intltool hal-dev \
dbus-glib-dev dbus-dev startup-notification-dev xorg-libxcb-dev xorg-xcb-util-dev \
xorg-xcb-util xorg-libX11-dev xorg-libXt-dev"

compile_rules() {
	# Binutils 2.22 break many packages build without LDFLAGS set correctly.
	export LDFLAGS="$LDFLAGS -Wl,--copy-dt-needed-entries -lXt"

	cp $stuff/fr.po $src/po

	./configure \
		--enable-hal \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make -j1 install || return 1

	# XDG autostart desktop file (lxsession will use it automaticaly)
	install -Dm644 $stuff/autostart/pcmanfm.desktop $fs/etc/xdg/autostart/pcmanfm.desktop
}

genpkg_rules() {
	copy @std
	DEPENDS="glibc-base glib util-linux-uuid xorg-libxcb xorg-xcb-util expat \
	zlib fontconfig freetype gtk+ atk cairo pango xorg-pixman libpng16 gamin \
	startup-notification dbus dbus-glib hal xorg-libICE xorg-libSM xorg-libX11 \
	xorg-libXau xorg-libXcomposite xorg-libXcursor xorg-libXdamage xorg-libXdmcp \
	xorg-libXext xorg-libXfixes xorg-libXinerama xorg-libXrender \
	hicolor-icon-theme shared-mime-info"
	TAGS="file-manager"
}
