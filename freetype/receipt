# SliTaz package receipt v2.

PACKAGE="freetype"
VERSION="2.9.1"
CATEGORY="x-window"
SHORT_DESC="A free, high-quality, and portable font engine"
MAINTAINER="devel@slitaz.org"
LICENSE="FTL GPL2"
WEB_SITE="https://www.freetype.org/"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/general/freetype2.html"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="$SF_MIRROR/$PACKAGE/$TARBALL"

BUILD_DEPENDS="automake libtool autoconf zlib-dev bzip2-dev libpng16-dev"
SPLIT="$PACKAGE-dev"

# Option "--harfbuzz" used in the task to install build dependency harfbuzz-dev
[ -n "$harfbuzz" ] && BUILD_DEPENDS="$BUILD_DEPENDS harfbuzz-dev"

compile_rules() {
	sed -ri "s:.*(AUX_MODULES.*valid):\1:" modules.cfg
	sed -ri "s:.*(#.*SUBPIXEL_RENDERING) .*:\1:g" \
		include/freetype/config/ftoption.h

#	./autogen.sh &&
	./configure \
		--disable-static \
		--with-bzip2 \
		--with-png \
		--enable-freetype-config \
		$CONFIGURE_ARGS &&
	make &&
	make install
}

genpkg_rules() {
	case $PACKAGE in
		freetype)
			copy @std
			DEPENDS="bzlib libharfbuzz libpng16 zlib"
			;;
		freetype-dev)
			copy @dev
			DEPENDS="freetype bzip2-dev harfbuzz-dev libpng16-dev zlib-dev"
			;;
	esac
}
