# SliTaz package receipt v2.

PACKAGE="freetype"
VERSION="2.7.1"
CATEGORY="x-window"
SHORT_DESC="A free, high-quality, and portable font engine"
MAINTAINER="pankso@slitaz.org"
LICENSE="FTL GPL2"
WEB_SITE="https://www.freetype.org/"
HOST_ARCH="i486 arm"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="$SF_MIRROR/$PACKAGE/$TARBALL"

BUILD_DEPENDS="automake libtool autoconf zlib-dev bzip2-dev libpng-dev"
SPLIT="freetype-dev"

# Option "--harfbuzz" used in task to install build dependency harfbuzz-dev
[ -n "$harfbuzz" ] && BUILD_DEPENDS="$BUILD_DEPENDS harfbuzz-dev"

# Rules to configure and make the package.
compile_rules()
{
	sed -ri "s:.*(AUX_MODULES.*valid):\1:" modules.cfg
	sed -ri "s:.*(#.*SUBPIXEL_(RENDERING|HINTING 2)) .*:\1:g" \
		include/freetype/config/ftoption.h

	./autogen.sh &&
	./configure \
		--sysconfdir=/etc \
		--disable-static \
		$CONFIGURE_ARGS &&
	make &&
	make install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	case $PACKAGE in
		freetype)
			copy @std
			DEPENDS="zlib libpng harfbuzz"
			;;
		freetype-dev)
			copy @dev
			DEPENDS="freetype bzip2-dev glib-dev harfbuzz-dev libpng-dev \
			pcre-dev zlib-dev"
			;;
	esac
}
