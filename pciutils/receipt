# SliTaz package receipt v2.

PACKAGE="pciutils"
VERSION="3.5.5"
CATEGORY="system-tools"
SHORT_DESC="Linux PCI Utilities"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://mj.ucw.cz/sw/pciutils/"
LFS="http://www.linuxfromscratch.org/blfs/view/stable/general/pciutils.html"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="ftp://atrey.karlin.mff.cuni.cz/pub/linux/pci/$TARBALL"

BUILD_DEPENDS="kmod-dev eudev-dev zlib-dev"
SPLIT="pciutils-dev"

compile_rules() {
	make \
		OPT="$CFLAGS -fPIC -DPIC" \
		ZLIB=yes \
		SHARED=no \
		PREFIX=/usr \
		SHAREDIR=/usr/share/misc \
		MANDIR=/usr/share/man \
		SBINDIR=/usr/bin \
		lib/libpci.a &&
	cp lib/libpci.a $src/../ &&

	make clean &&
	make \
		OPT="$CFLAGS" \
		ZLIB=yes \
		SHARED=yes \
		PREFIX=/usr \
		SBINDIR=/usr/bin \
		SHAREDIR=/usr/share/misc \
		MANDIR=/usr/share/man \
		all &&

	make \
		SHARED=yes \
		PREFIX=/usr \
		SBINDIR=/usr/bin \
		SHAREDIR=/usr/share/misc \
		MANDIR=/usr/share/man \
		DESTDIR=$install \
		install install-lib &&

	mv $src/../libpci.a $install/usr/lib
}

genpkg_rules() {
	case $PACKAGE in
		pciutils)
			copy @std
			rm -rf $fs/usr/share/
			DEPENDS="eudev kmod liblzma zlib   pciids"
			;;
		*-dev)
			copy @dev
			;;
	esac
}
