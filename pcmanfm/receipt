# SliTaz package receipt v2.

PACKAGE="pcmanfm"
VERSION="1.3.0"
CATEGORY="system-tools"
SHORT_DESC="Light and easy to use file manager"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="https://wiki.lxde.org/en/PCManFM"
LFS="http://www.linuxfromscratch.org/blfs/view/stable/lxde/pcmanfm.html"

TARBALL="$PACKAGE-$VERSION.tar.xz"
#WGET_URL="$SF_MIRROR/$PACKAGE/files/$TARBALL" # SF download problems
WGET_URL="http://git.lxde.org/gitweb/?p=lxde/pcmanfm.git;a=snapshot;h=$VERSION;sf=txz"

BUILD_DEPENDS_arm="gtk+-dev dbus-glib-dev dbus-dev startup-notification-dev \
xorg-libxcb-dev xorg-xcb-util-dev libfm-dev menu-cache-dev expat-dev libfm-gtk \
gtk-doc libtool"
BUILD_DEPENDS="intltool xorg-libX11-dev pango-dev libfm-dev gtk+-dev automake"

compile_rules() {
	# tarball from git.lxde.org requires this step
	[ -e "$src/configure" ] || ./autogen.sh

	./configure $CONFIGURE_ARGS &&
	make &&
	make install || return 1

	mkdir -p $install/etc/xdg/pcmanfm/
	# default settings
	cp -r $stuff/default/ $install/etc/xdg/pcmanfm/
	# XDG autostart desktop file (lxsession will use it automatically)
	cp -r $stuff/autostart/ $install/etc/xdg/
	# add custom actions
	mkdir -p $install/usr/share/file-manager
	cp -r $stuff/actions/ $install/usr/share/file-manager
	install -m755 $stuff/gvfs-mount-archive.sh $install/usr/bin

	# avoid warning about missed modules dir
	mkdir -p $install/usr/lib/pcmanfm
}

genpkg_rules() {
	copy @std
	DEPENDS="atk cairo gdk-pixbuf glib gtk+ libfm libfm-gtk pango xorg-libX11"
	SUGGESTED="gvfs"
	TAGS="file-manager"
}
