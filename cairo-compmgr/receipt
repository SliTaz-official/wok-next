# SliTaz package receipt v2.

PACKAGE="cairo-compmgr"
VERSION="0.3.0"
CATEGORY="meta"
SHORT_DESC="Cairo composite manager"
MAINTAINER="al.bobylev@gmail.com"
LICENSE="GPL2"
WEB_SITE="https://github.com/gandalfn/Cairo-Composite-Manager"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="http://download.tuxfamily.org/ccm/$PACKAGE/$TARBALL"

BUILD_DEPENDS="xorg-libXcomposite-dev xorg-libXdamage-dev xorg-libXext-dev \
xorg-libXi-dev xorg-libSM-dev cairo-dev xorg-pixman-dev gtk2-dev vala \
xorg-libICE-dev xorg-libX11-dev util-linux-uuid-dev intltool"
SPLIT="$PACKAGE-dev"

compile_rules() {
	# make needed pkg-config file
	ln -s $(ls /usr/lib/pkgconfig/libvala-*.pc | sed q) /usr/lib/pkgconfig/vala-1.0.pc

	# localization
	cp -a $stuff/cairo-compmgr.pot $src/po
	cp -a $stuff/ru.po $src/po

	export LDFLAGS="$LDFLAGS $(pkg-config --libs ice gmodule-2.0 x11)"

	./configure $CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install || return 1

	rm -f $install/usr/share/applications/*
}

genpkg_rules() {
	case $PACKAGE in
		cairo-compmgr)
			copy @std
			DEPENDS="cairo gdk-pixbuf glib gtk2 pango vala xorg-libICE \
			xorg-libSM xorg-libX11 xorg-libXcomposite xorg-libXdamage \
			xorg-libXext xorg-libXfixes xorg-libXi xorg-pixman"
			;;
		*-dev)
			copy @dev
			DEPENDS="cairo-compmgr \
			gconf-dev cairo-dev gtk2-dev"
			;;
	esac
}
