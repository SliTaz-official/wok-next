# SliTaz package receipt v2.

PACKAGE="compiz-core"
VERSION="0.8.12.3"
CATEGORY="x-window"
SHORT_DESC="Compiz is an OpenGL compositing manager for 3D effect"
MAINTAINER="pankso@slitaz.org"
LICENSE="MIT GPL LGPL"
WEB_SITE="https://github.com/compiz-reloaded"

TARBALL="$PACKAGE-$VERSION.tar.xz"
WGET_URL="$WEB_SITE/compiz/releases/download/v$VERSION/compiz-$VERSION.tar.xz"

BUILD_DEPENDS="xorg-dev intltool librsvg-dev libxslt-dev pango-dev libtool \
startup-notification-dev mesa-dev file dbus-dev dbus-glib-dev cairo-dev \
util-linux-uuid-dev expat-dev xorg-libxshmfence-dev libglu-mesa-dev "
SPLIT="compiz-core-dev"

compile_rules() {
	./configure \
		--prefix=/usr \
		--enable-shared \
		--enable-librsvg \
		--enable-dbus \
		--enable-dbus-glib \
		--enable-glib \
		--disable-static \
		--disable-inotify &&
	make && make install
}

genpkg_rules() {
	case $PACKAGE in
		compiz-core)
			mkdir -p $fs/usr/lib $fs/usr/share/locale
			cp -a $install/usr/bin $fs/usr
			cp -a $install/usr/lib/compiz $fs/usr/lib
			cp -a $install/usr/lib/*.so* $fs/usr/lib
			cp -a $install/usr/share/compiz $fs/usr/share
			cp -a $install/usr/share/icons $fs/usr/share
			cp -a $install/usr/share/locale/ru $fs/usr/share
			rm -rf $fs/usr/lib/compiz/*.la
			sed 's|bash|sh|' -i $fs/usr/bin/compiz-decorator
			DEPENDS="librsvg libxslt mesa libglu-mesa dbus dbus-glib \
			startup-notification compiz-bcop compiz-libcompizconfig"
			;;
		*-dev)
			mkdir -p $fs/usr/lib/compiz $fs/usr/share/compiz
			cp -a $install/usr/include $fs/usr
			cp -a $install/usr/lib/pkgconfig $fs/usr/lib
			cp -a $install/usr/lib/*.la $fs/usr/lib
			cp -a $install/usr/lib/compiz/*.la $fs/usr/lib/compiz/
			;;
	esac
}
