# SliTaz package receipt v2.

PACKAGE="galculator"
VERSION="2.1.3"
CATEGORY="system-tools"
SHORT_DESC="Graphical scientific calculator"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://galculator.sourceforge.net/"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="$SF_MIRROR/$PACKAGE/$TARBALL"

BUILD_DEPENDS="gtk+-dev flex sdft intltool"

COOKOPTS="!pixmaps !menus"

compile_rules() {
	# Binutils 2.22 break many packages build without LDFLAGS set correctly.
	export LDFLAGS="$LDFLAGS -Wl,--copy-dt-needed-entries"

	./configure \
		--disable-gtk3 \
		--disable-quadmath \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install || return 1

	sdft $install/usr/share/applications/galculator.desktop -i -tf \
		-a "Name[fr]=Calculatrice scientifique" \
		-a "Name[pt]=Calculadora Científica" \
		-a "Name[pt_BR]=Calculadora Científica" \
		-a "Name[ru]=Инженерный калькулятор" \
		-a "Name[zh_CN]=科学计算器" \
		-a "Comment[ru]=Выполняйте простые и инженерные вычисления" \
		-s "Icon=accessories-calculator" \
		-s "Categories=Utility;Calculator;"
}

genpkg_rules() {
	copy @std
	rm -r $fs/usr/share/pixmaps
	find $fs -name '*gtk3*' -delete
	sed -i 's|^[ ]*||g' $fs/usr/share/galculator/ui/*
	DEPENDS="gtk+"
}
