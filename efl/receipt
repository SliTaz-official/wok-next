# SliTaz package receipt v2.

PACKAGE="efl"
VERSION="1.8.4"
CATEGORY="base-system"
SHORT_DESC="EFL Core data structure library"
MAINTAINER="domcox@slitaz.org"
LICENSE="LGPL2.1"
WEB_SITE="http://www.enlightenment.org/"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="http://download.enlightenment.org/rel/libs/$PACKAGE/$TARBALL"

BUILD_DEPENDS="gstreamer0-dev gst0-plugins-base-dev check-dev \
util-linux-mount-dev util-linux-blkid-dev eudev-dev openssl-dev dbus-dev \
libjpeg-turbo-dev fribidi-dev giflib-dev tiff-dev libsndfile-dev lua-dev \
xorg-libXp-dev xorg-printproto xorg-scrnsaverproto xorg-libXScrnSaver-dev \
xorg-libXcursor-dev xorg-libXcomposite-dev xorg-libXinerama-dev \
xorg-libXrandr-dev xorg-libXtst-dev mesa-dev util-linux-uuid-dev libxml2-dev \
flac-dev autoconf automake expat-dev xorg-libxshmfence-dev"
SPLIT="efl-dev"

compile_rules() {
	sed -i 's/DGifCloseFile([^)]*/&,NULL/' \
		src/modules/evas/loaders/gif/evas_image_load_gif.c

	autoreconf -v &&
	ac_aux_dir=$src \
	./configure \
		--disable-static \
		--disable-doc \
		--disable-pulseaudio \
		--disable-physics \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make -j1 DESTDIR=$install install
}

genpkg_rules() {
	case $PACKAGE in
		efl)
			copy @std
			rm -rf $fs/usr/share/mime
			DEPENDS="gstreamer0 gst0-plugins-base util-linux-mount \
			util-linux-blkid eudev openssl dbus libjpeg-turbo fribidi giflib \
			tiff libsndfile lua xorg-libXp xorg-libXScrnSaver mesa bullet \
			util-linux-uuid"
			TAGS="e enlightenment efl"
			;;
		efl-dev)
			copy @dev
			DEPENDS="efl gstreamer0-dev gst0-plugins-base-dev check-dev \
			util-linux-mount-dev util-linux-blkid-dev eudev-dev openssl-dev \
			dbus-dev libjpeg-turbo-dev fribidi-dev giflib-dev tiff-dev \
			libsndfile-dev lua-dev xorg-libXp-dev xorg-printproto \
			xorg-scrnsaverproto xorg-libXScrnSaver-dev mesa-dev \
			util-linux-uuid-dev libxml2-dev"
			;;
	esac
}
