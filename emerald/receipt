# SliTaz package receipt v2.

PACKAGE="emerald"
VERSION="0.8.14"
CATEGORY="x-window"
SHORT_DESC="Window decorator for Compiz"
MAINTAINER="al.bobylev@gmail.com"
LICENSE="GPL2"
WEB_SITE="https://gitlab.com/compiz/emerald"

TARBALL="$PACKAGE-v$VERSION.tar.bz2"
WGET_URL="https://gitlab.com/compiz/emerald/-/archive/v$VERSION/$TARBALL"

BUILD_DEPENDS="automake gettext-dev libtool intltool libxrender-dev \
libxi-dev gtk3-dev libwnck3-dev compiz-dev cairo-dev pango-dev"
SPLIT="$PACKAGE-dev"

DEPENDS_std="atk libcairo compiz gdk-pixbuf glib gtk3 libwnck3 pango libx11 \
libxi libxrender"
DEPENDS_dev="emerald atk-dev cairo-dev compiz-dev gdk-pixbuf-dev glib-dev \
gtk3-dev libwnck3-dev pango-dev libx11-dev libxi-dev \
libxrender-dev"

TAGS="compiz"

compile_rules() {
	./autogen.sh \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install || return 1

	# save original emerald theme as 'default':
	mkdir -p $install/usr/share/emerald/themes/default/
	cd       $install/usr/share/emerald/themes/default/
	for i in $(ls ../../theme/*.png); do
		ln -s $i $(basename $i)
	done
	mv $install/usr/share/emerald/theme/theme.ini \
	   $install/usr/share/emerald/themes/default/theme.ini

	# make SliTaz theme
	ln -sf ../theme     $install/usr/share/emerald/themes/SliTaz
	cp $stuff/theme.ini $install/usr/share/emerald/themes/SliTaz/

	# custom SliTaz config
	cp -f $stuff/settings.ini $install/usr/share/emerald/
}

genpkg_rules() {
	case $PACKAGE in
		emerald) copy @std; DEPENDS="$DEPENDS_std";;
		*-dev)   copy @dev; DEPENDS="$DEPENDS_dev";;
	esac
}
