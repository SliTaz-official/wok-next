# SliTaz package receipt.

PACKAGE="linux-module-headers"
VERSION="4.9.4"
CATEGORY="development"
SHORT_DESC="Header files and scripts for building modules for Linux Kernel"
MAINTAINER="devel@slitaz.org"
LICENSE="GPL2"
WEB_SITE="https://www.kernel.org/"
KVERSION="$VERSION-slitaz"

WANTED="linux"
DEPENDS="slitaz-toolchain"

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	mkdir -p $fs/lib/modules/$KVERSION $fs/usr
	cp -a $install/usr/src $fs/usr
}

pre_remove() {
	if [ -e "$1/usr/src/linux" ]; then
		rm -rf "$1/usr/src/linux"
	fi
}

post_install() {
	# Added soft link to make it easier to point to kernel folder
	[ -L "$1/usr/src/linux" ] && rm -f "$1/usr/src/linux"
	ln -sf /usr/src/linux-$KVERSION "$1/usr/src/linux"
	ln -sf /usr/src/linux-$KVERSION "$1/lib/modules/$KVERSION/build"
}
