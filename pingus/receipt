# SliTaz package receipt v2.

# FIXME : Check if the tarball comes with a .desktop and a pixmap files
# Then remove the section in genpkg_rules() that creates them

PACKAGE="pingus"
VERSION="0.7.3"
CATEGORY="games"
SHORT_DESC="Pingus is a free Lemmings-like game"
MAINTAINER="chadi.elahmad@gmail.com"
LICENSE="GPL2"
WEB_SITE="https://pingus.seul.org/"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="http://pingus.seul.org/files/$TARBALL"

BUILD_DEPENDS="scons2 libsdl-dev libsdl-image-dev libsdl-mixer-dev boost-dev \
boost-signals libpng16-dev"

compile_rules() {
	sed -i 's/png_ptr->jmpbuf/png_jmpbuf(png_ptr)/' src/screenshot.cpp
	scons || return 1

	mkdir -p $install/usr/bin $install/usr/share/pingus
	cp -a $src/pingus $install/usr/bin
	cp -a $src/data   $install/usr/share/pingus

	# the tarball doesn't contain any .desktop file, nor a pixmap
	# let's create them
	mkdir -p $install/usr/share/pixmaps
	mkdir -p $install/usr/share/applications
	cp $src/data/images/core/editor/actions.png \
		$install/usr/share/pixmaps/pingus.png
	cat > $install/usr/share/applications/pingus.desktop <<EOF
[Desktop Entry]
Name=Pingus
Exec=pingus -w
Type=Application
Categories=Application;Game;
Icon=pingus
EOF
}

genpkg_rules() {
	copy @std
	DEPENDS="libsdl libsdl-image libsdl-mixer boost-signals gcc-lib-base"
}
