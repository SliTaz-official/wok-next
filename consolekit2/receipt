# SliTaz package receipt v2.

PACKAGE="consolekit2"
VERSION="1.0.2"
CATEGORY="system-tools"
SHORT_DESC="ConsoleKit framework"
MAINTAINER="al.bobylev@gmail.com"
LICENSE="GPL2"
WEB_SITE="https://github.com/Consolekit2/ConsoleKit2"
LFS="http://www.linuxfromscratch.org/blfs/view/stable/postlfs/consolekit.html"

TARBALL="ConsoleKit2-$VERSION.tar.bz2"
WGET_URL="https://github.com/Consolekit2/ConsoleKit2/releases/download/$VERSION/$TARBALL"

BUILD_DEPENDS="xorg-libX11-dev gettext dbus-dev glib-dev polkit-dev eudev-dev \
xmlto libxslt docbook-xsl libxml2-tools"
SPLIT="consolekit2-dev"

compile_rules() {
	./configure \
		--localstatedir=/var \
		--enable-udev-acl \
		--enable-polkit \
		--with-xinitrc-dir=/etc/X11/app-defaults/xinitrc.d \
		--with-systemdsystemunitdir=no \
		--enable-docbook-docs \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install || return 1

	mv -v $install/etc/X11/app-defaults/xinitrc.d/90-consolekit \
		  $install/etc/X11/app-defaults/xinitrc.d/90-consolekit.sh
}

genpkg_rules() {
	case $PACKAGE in
		consolekit2)
			copy @std
			DEPENDS="acl attr dbus eudev glib libffi pcre polkit \
			util-linux-blkid util-linux-mount util-linux-uuid xorg-libX11 \
			xorg-libXau xorg-libXdmcp xorg-libxcb zlib"
			;;
		*-dev)
			copy @dev
			DEPENDS="consolekit2 dbus-dev"
			;;
	esac
}
