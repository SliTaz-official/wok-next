# SliTaz package receipt v2.

PACKAGE="libxml2"
VERSION="2.9.8"
CATEGORY="system-tools"
SHORT_DESC="XML C parser and toolkit"
MAINTAINER="devel@slitaz.org"
LICENSE="MIT"
WEB_SITE="http://xmlsoft.org/"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/general/libxml2.html"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="http://xmlsoft.org/sources/$TARBALL"
TARBALL_SHA1="66bcefd98a6b7573427cf66f9d3841b59eb5b8c3"

BUILD_DEPENDS="zlib-dev xz-dev python3-dev ncurses-dev readline-dev"
SPLIT="$PACKAGE-tools $PACKAGE-python $PACKAGE-dev"

COPY_std="libxml2.so*"
COPY_tools="xmllint xmlcatalog"
COPY_python="site-packages/*.py libxml2mod.so"
COPY_dev="@dev *.sh"

DEPENDS_std="liblzma zlib"
DEPENDS_tools="$PACKAGE readline"
DEPENDS_python="$PACKAGE python3" # libxslt
DEPENDS_dev="xz-dev zlib-dev   $PACKAGE-tools"

CAT_tools="system-tools|utilities"
CAT_python="development|adapter for the Python"

compile_rules() {
	sed -i '/_PyVerify_fd/,+1d' python/types.c

	./configure \
		--disable-static \
		--with-history \
		--with-python=/usr/bin/python3 \
		$CONFIGURE_ARGS &&
	fix libtool &&
	make &&
	make install || return 1

	find $install -name '*.sh' -exec chmod +x '{}' \;
}
