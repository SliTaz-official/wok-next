# SliTaz package receipt v2.

PACKAGE="alsa-utils"
VERSION="1.1.6"
CATEGORY="multimedia"
SHORT_DESC="Command line utilities for the ALSA project"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://www.alsa-project.org/"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/multimedia/alsa-utils.html"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="ftp://ftp.alsa-project.org/pub/utils/$TARBALL"

BUILD_DEPENDS="alsa-lib-dev ncurses-dev gettext eudev-dev"
SPLIT="alsa-utils-test alsa-info alsa-utils"

compile_rules() {
	./configure \
		--disable-alsaconf \
		--disable-bat \
		--disable-xmlto \
		--with-curses=ncursesw \
		$CONFIGURE_ARGS &&
	make &&
	make install || return 1

	# Remove empty dir
	rmdir $install/usr/share/man/man7

	install -Dm644 $stuff/alsamixer.desktop \
		$install/usr/share/applications/alsamixer.desktop

	# Declare asound.state
	touch $install/var/lib/alsa/asound.state

	# For conf we need /var/tmp
	install -dm1777 $install/var/tmp
}

genpkg_rules() {
	case $PACKAGE in
		alsa-utils-test)
			copy speaker-test speaker-test/ *.wav
			CAT="multimedia|speaker test"
			DEPENDS="alsa-lib"
			;;
		alsa-info)
			copy alsa-info.sh
			CAT="multimedia|gather ALSA subsystem information"
			DEPENDS="alsa-utils bash dialog ncurses-extra pciutils wget"
			;;
		alsa-utils)
			copy @std @rm
			DEPENDS="alsa-lib ncurses ncurses-libform ncurses-libmenu \
			ncurses-libpanel"
			CONFIG_FILES="/var/lib/alsa/asound.state"
			;;
	esac
}
