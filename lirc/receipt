# SliTaz package receipt v2.

PACKAGE="lirc"
VERSION="0.9.4d"
CATEGORY="utilities"
SHORT_DESC="Enables decoding and sending signals of many commonly used remote \
controls"
MAINTAINER="rcx@zoominternet.net"
LICENSE="GPL2"
TARBALL="$PACKAGE-$VERSION.tar.gz"
WEB_SITE="http://www.lirc.org/"
WGET_URL="$SF_MIRROR/$PACKAGE/$TARBALL"

BUILD_DEPENDS="linux linux-module-headers python libusb-dev libirman-dev \
portaudio-dev alsa-lib-dev libusb-compat-dev util-linux-uuid-dev \
libftdi-dev jack-dev libxslt python3 udev-dev"
SPLIT="lirc-dev"

compile_rules() {
	KERNEL_VERSION=$(grep  ^VERSION= $WOK/linux/receipt | cut -d "=" -f2 | sed -e 's/"//g')
	sed -i "s/uname -r/echo $KERNEL_VERSION-slitaz/g" configure

	./configure \
		--with-x \
		--with-driver=all \
		--with-kerneldir=/usr/src/linux \
		--with-moduledir=/lib/modules/$KERNEL_VERSION-slitaz/kernel/misc \
		$CONFIGURE_ARGS &&
	make 2>&1 | sed 's/ERROR/Error/;/lirc_dev\/Module/d' &&
	make DESTDIR=$DESTDIR install 2>&1 | sed '/depmod:/d'
}

genpkg_rules() {
	case $PACKAGE in
		lirc)
			copy @std
			DEPENDS="glibc-base libusb libusb-compat libftdi xorg-libXau \
			libirman portaudio alsa-lib util-linux-uuid"
			;;
		*-dev)
			copy @dev
			;;
	esac
}
