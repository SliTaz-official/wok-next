# SliTaz package receipt v2.

PACKAGE="inkscape"
VERSION="0.92.2"
CATEGORY="graphics"
SHORT_DESC="Professional quality vector graphics software"
MAINTAINER="devel@slitaz.org"
LICENSE="GPL2"
WEB_SITE="https://inkscape.org/"
LFS="http://www.linuxfromscratch.org/blfs/view/svn/xsoft/inkscape.html"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="https://gitlab.com/inkscape/inkscape/repository/INKSCAPE_${VERSION//./_}/archive.tar.bz2"

BUILD_DEPENDS="cmake gtest pango-dev fontconfig-dev glib-dev gsl-dev \
gnome-vfs-dev lcms2-dev gc-dev poppler-dev libwpg-dev libvisio-dev libcdr-dev \
libwpd-dev popt-dev potrace-dev gtkmm-dev gtk2-dev gtkspell-dev boost-dev \
aspell-dev libxslt-dev imagemagick6-dev gettext-dev dbus-dev"
COOKOPTS="!svgz" # don't process svg or they will be broken
SPLIT="$PACKAGE-examples $PACKAGE-tutorials $PACKAGE"

compile_rules() {
	mkdir build
	cd    build
	cmake \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_BUILD_TYPE=Release \
		-DWITH_DBUS=ON \
		.. &&
	make &&
	make install || return 1

	rm $install/usr/lib/inkscape/lib*_LIB.a

#		-DCMAKE_BUILD_TYPE=Release \
#		-DCMAKE_INSTALL_PREFIX:PATH=/usr \
#		-DINCLUDE_INSTALL_DIR:PATH=/usr/include \
#		-DLIB_INSTALL_DIR:PATH=/usr/lib \
#		-DSYSCONF_INSTALL_DIR:PATH=/etc \
#		-DSHARE_INSTALL_PREFIX:PATH=/usr/share \
#		-DCMAKE_ENABLE_LCMS=ON \
#		-DCMAKE_ENABLE_POPPLER_CAIRO=ON \
#		-DCMAKE_WITH_NLS=ON
}

genpkg_rules() {
	case $PACKAGE in
		*-examples)
			copy examples/
			CAT="graphics|examples"
			;;
		*-tutorials)
			copy tutorials/
			CAT="graphics|tutorials"
			;;
		inkscape)
			copy @std @rm
			DEPENDS="aspell atk atkmm libcairo cairomm fontconfig freetype gc \
			gdk-pixbuf glib glibmm gnome-vfs gsl gtk2 gtkmm gtkspell \
			imagemagick6 lcms2 libcdr libgiomm libgomp libjpeg-turbo libpng \
			librevenge libsigc++ libvisio libwpg libxml2 libxslt pango pangomm \
			perl libpoppler popt potrace python libx11 zlib"
			TAGS="image vector editor svg"
			;;
	esac
}
