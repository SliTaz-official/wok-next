# SliTaz package receipt v2.

PACKAGE="poppler"
VERSION="0.51.0"
CATEGORY="office"
SHORT_DESC="PDF rendering library"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="https://poppler.freedesktop.org/"

TARBALL="$PACKAGE-$VERSION.tar.xz"
WGET_URL="http://poppler.freedesktop.org/$TARBALL"

BUILD_DEPENDS="tiff-dev zlib-dev libjpeg-turbo-dev libpng16-dev freetype-dev \
fontconfig-dev cairo-dev lcms2-dev"
SPLIT="poppler-apps poppler-dev"

# Rules to configure and make the package.
compile_rules()
{
	./configure \
		--sysconfdir=/etc \
		--disable-static \
		--enable-build-type=release \
		--enable-cmyk \
		--enable-xpdf-headers \
		--with-testdatadir=$PWD/testfiles \
		$CONFIGURE_ARGS &&
	make && make install &&

	docdir="$install/usr/share/doc/poppler-$VERSION" &&
	install -v -m755 -d        $docdir &&
	install -v -m644 README*   $docdir &&
	cp -vr glib/reference/html $docdir
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	case $PACKAGE in
		poppler)
			copy *.so*
			DEPENDS="cairo fontconfig freetype glib lcms2 libjpeg-turbo \
			libpng16 tiff zlib"
			;;
		poppler-apps)
			copy bin/
			CAT="office|utilities to manipulate PDF file"
			DEPENDS="poppler cairo freetype lcms2 zlib"
			;;
		poppler-dev)
			copy @dev
			remove_already_packed
			DEPENDS="poppler poppler-apps cairo-dev glib-dev"
			;;
	esac
}
