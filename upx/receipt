# SliTaz package receipt.

PACKAGE="upx"
VERSION="3.93"
CATEGORY="system-tools"
SHORT_DESC="Ultimate Packer for eXecutables (free version using UCL compression)"
MAINTAINER="devl547@gmail.com"
LICENSE="GPL2"
WEB_SITE="https://upx.github.io/"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="https://github.com/upx/upx/archive/v$VERSION.tar.gz"
TARBALL2="upx-lzma-sdk-$VERSION.tar.gz"
WGET_URL2="https://github.com/upx/upx-lzma-sdk/archive/v$VERSION.tar.gz"

DEPENDS="ucl zlib"
BUILD_DEPENDS="ucl-dev zlib-dev perl"

# Rules to configure and make the package.
compile_rules()
{
	[ -s $SOURCES_REPOSITORY/$TARBALL2 ] ||
		wget -O $SOURCES_REPOSITORY/$TARBALL2 $WGET_URL2
	tar -xf $SOURCES_REPOSITORY/$TARBALL2
	rm -r $src/src/lzma-sdk
	mv    $src/$(basename $TARBALL2 .tar.gz) $src/src/lzma-sdk

	make CHECK_WHITESPACE=/bin/true all

	mkdir -p $install/usr/bin $install/usr/share/man/man1
	cp -a $src/src/upx.out $install/usr/bin/upx
	cp -a $src/doc $install/usr/share
	rm $install/usr/share/doc/Makefile
	mv $install/usr/share/doc/upx.1 $install/usr/share/man/man1
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	cook_copy_files upx
}
