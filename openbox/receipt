# SliTaz package receipt v2.

PACKAGE="openbox"
VERSION="3.6.1"
CATEGORY="x-window"
SHORT_DESC="Small-footprint and standard compliant Window Manager"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL2"
WEB_SITE="http://openbox.org/"
HOST_ARCH="i486 arm"

TARBALL="openbox-$VERSION.tar.gz"
WGET_URL="http://openbox.org/dist/openbox/$TARBALL"

BUILD_DEPENDS="glib-dev pango-dev \
gettext xorg-libXcursor-dev xorg-libICE-dev xorg-libSM-dev xorg-libXrandr-dev \
xorg-libXinerama-dev startup-notification-dev automake libtool docbook-utils \
xorg-libXi-dev"
BUILD_DEPENDS_arm="pango-dev glib-dev xorg-libXft-dev util-linux-uuid-dev \
libxml2-dev xcb-util-dev"
SPLIT="openbox-themes openbox-python openbox-dev"
SIBLINGS="openbox-max"

# Rules to configure and make the package.
compile_rules()
{
	# openbox required reconfiguration after patching...
	autoreconf -fi &&

	./configure \
		--sysconfdir=/etc \
		--libexecdir=/usr/lib/openbox \
		--disable-static \
		--docdir=/usr/share/doc/openbox-$VERSION \
		$CONFIGURE_ARGS &&
	make &&
	make -j1 DESTDIR=$DESTDIR install &&

	# Pipe menu.
	cp $stuff/open-folder-menu.sh $install/usr/lib/openbox/
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	case $PACKAGE in
		openbox)
			copy obxprop openbox openbox-session *.so* openbox-autostart \
			pixmaps/ Onyx*/ xsessions/openbox.desktop open-folder-menu.sh
			# SliTaz /etc/xdg/openbox/* files are in 'slitaz-configs' package
			TAGS="window-manager"
			SUGGESTED="obconf spacefm pcmanfm hsetroot wbar2 conky"
			DEPENDS="pango xorg-libSM xorg-libXcursor xorg-libXi \
			xorg-libXinerama xorg-libXrandr slitaz-configs"
			# Handle SliTaz arch: /etc/slitaz/slitaz.conf
			case "$SLITAZ_ARCH" in
				i?86) DEPENDS="$DEPENDS startup-notification";;
				arm*) DEPENDS="$DEPENDS hsetroot tint2";;
			esac
			;;
		openbox-python)
			copy openbox-xdg-autostart
			CAT="development|Python script - XDG auto start standard support"
			DEPENDS="openbox python python-xdg"
			;;
		openbox-themes)
			copy themes/
			remove_already_packed
			CAT="customiz|official themes set"
			;;
		openbox-dev)
			copy @dev
			DEPENDS="openbox openbox-themes bzip2-dev \
			fontconfig-dev freetype-dev glib-dev harfbuzz-dev libffi-dev \
			liblzma-dev libpng16-dev libxcb-dev libxml2-dev pango-dev pcre-dev \
			util-linux-uuid-dev xorg-libICE-dev xorg-libSM-dev xorg-libX11-dev \
			xorg-libXau-dev xorg-libXdmcp-dev xorg-libXext-dev xorg-libXft-dev \
			xorg-libXi-dev xorg-libXinerama-dev xorg-libXrandr-dev \
			xorg-libXrender-dev zlib-dev"
			;;
	esac
}
