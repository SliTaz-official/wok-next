# SliTaz package receipt.

PACKAGE="hydra"
VERSION="7.3"
CATEGORY="system-tools"
SHORT_DESC="THC password cracker for FTP, HTTP, HTTPS, SMB, etc."
MAINTAINER="devel@slitaz.org"
LICENSE="GPL3"
WEB_SITE="https://github.com/vanhauser-thc/thc-hydra"

TARBALL="$PACKAGE-$VERSION-src.tar.gz"
WGET_URL="http://freeworld.thc.org/releases/$TARBALL"

BUILD_DEPENDS="openssl-dev apr-dev gtk2-dev libssh-dev libmysqlclient \
postgresql-dev subversion-dev libidn-dev mysql-dev"

compile_rules() {
	./configure \
		--prefix=/usr \
		$CONFIGURE_ARGS
	sed -i s/'cp -v'/'cp'/ hydra-gtk/make_xhydra.sh
	sed -i -e "s|gcc|gcc $( /usr/bin/apr-1-config --cppflags --cflags)|" \
		-e 's|^XLIBPATHS=|&-L/usr/lib/postgresql |' \
		-e 's|^XIPATHS= |&-I/usr/include/apr-1 |' Makefile
	make
	[ -f hydra ]
}

genpkg_rules() {
	mkdir -p $fs/usr/bin
	cp -a $src/hydra $fs/usr/bin
	cp -a $src/xhydra $fs/usr/bin
	DEPENDS="gtk2 openssl xorg-libXdamage apr libssh libmysqlclient \
	libidn libpostgresqlclient libsvn"
}
