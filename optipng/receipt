# SliTaz package receipt v2.

PACKAGE="optipng"
VERSION="0.7.6"
CATEGORY="utilities"
SHORT_DESC="Compress and optimize PNG images"
MAINTAINER="pankso@slitaz.org"
LICENSE="zlib/libpng"
WEB_SITE="http://optipng.sourceforge.net/"
TAGS="image compression"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="$SF_MIRROR/$PACKAGE/$TARBALL"

BUILD_DEPENDS="libpng16-dev zlib-dev"
SPLIT="optipng-static"

# Rules to configure and make the package.
compile_rules()
{
	sed -i 's|prefix)/man|prefix)/share/man|' configure

	# make statically linked binary
	LDFLAGS='-static' \
	./configure \
		-prefix=/usr \
		-bindir=/usr/sbin \
		-with-system-libpng &&
	make && make install &&

	# make dynamically linked binary
	make clean &&
	./configure \
		-prefix=/usr \
		-with-system-libpng &&
	make && make install
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	case $PACKAGE in
		optipng)
			copy bin/optipng
			DEPENDS="libpng16 zlib"
			;;
		optipng-static)
			copy sbin/optipng
			CAT="graphics|static binary"
			PROVIDE="optipng"
			DEPENDS=" "
			;;
	esac
}
