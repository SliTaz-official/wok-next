# SliTaz package receipt.

PACKAGE="gnupg"
VERSION="2.1.21"
CATEGORY="security"
SHORT_DESC="Free implementation of the OpenPGP"
MAINTAINER="pankso@slitaz.org"
LICENSE="GPL3"
WEB_SITE="https://www.gnupg.org/"

TARBALL="$PACKAGE-$VERSION.tar.bz2"
WGET_URL="https://www.gnupg.org/ftp/gcrypt/gnupg/$TARBALL"
# https://www.gnupg.org/download/integrity_check.html
TARBALL_SHA1="1852c066bc21893bc52026ead78edf50fdf15e13"

BUILD_DEPENDS="libgpg-error-dev libassuan-dev libgcrypt-dev libksba-dev \
npth-dev perl libusb-dev sqlite3-dev gettext zlib-dev readline-dev texinfo"

# Rules to configure and make the package.
compile_rules()
{
	./configure \
		--enable-symcryptrun \
		--enable-maintainer-mode \
		--docdir=/usr/share/doc/gnupg-$VERSION \
		$CONFIGURE_ARGS &&
	make && make install &&

	makeinfo --html --no-split -o doc/gnupg_nochunks.html doc/gnupg.texi &&
	makeinfo --plaintext       -o doc/gnupg.txt           doc/gnupg.texi &&

	docdir="$install/usr/share/doc/gnupg-$VERSION" &&
	install -v -m755 -d $docdir/html &&
	install -v -m644    doc/gnupg_nochunks.html  $docdir/html/gnupg.html &&
	install -v -m644    doc/*.texi doc/gnupg.txt $docdir &&

	for f in gpg gpgv; do
		ln -svf ${f}2.1 $install/usr/share/man/man1/$f.1 &&
		ln -svf ${f}2   $install/usr/bin/$f
	done
	unset f
}

# Rules to gen a SliTaz package suitable for Tazpkg.
genpkg_rules()
{
	copy @std
	DEPENDS="libassuan libgcrypt libgpg-error libksba libsqlite3 libusb ncurses \
	npth readline zlib   bzlib pinentry"
}
