# SliTaz package receipt v2.

PACKAGE="monkey"
VERSION="1.5.6"
CATEGORY="network"
SHORT_DESC="Lightweight HTTP server"
MAINTAINER="necrophcodr@necrophcodr.me"
LICENSE="APL2"
WEB_SITE="http://monkey-project.com"

TARBALL="$PACKAGE-$VERSION.tar.gz"
WGET_URL="$WEB_SITE/releases/${VERSION%.*}/$TARBALL"

BUILD_DEPENDS="findutils"
SPLIT="monkey-dev"

compile_rules() {
	./configure \
		--enable-shared \
		--prefix=/usr \
		--datadir=/var/www \
		--pidfile=/var/run/monkey.pid \
		--sysconfdir=/etc/monkey \
		--disable-plugins=mbedtls \
		--mandir=/usr/share/man \
		--plugdir=/usr/share/monkey/plugins &&
	make &&
	make DESTDIR=$install install
}

genpkg_rules() {
	case $PACKAGE in
		monkey)
			mkdir -p $fs/usr
			cp -a $install/usr/bin $fs/usr/
			cp -a $install/usr/share $fs/usr/
			cp -a $install/etc $fs/
			cp -a $install/var $fs/
			mkdir -p $fs/usr/share/monkey/samples
			mv $fs/var/www/ $fs/usr/share/monkey/samples/htdocs
			;;
		*-dev)
			mkdir -p $fs/usr
			cp -a $install/usr/include $fs/usr
			cp -a $install/usr/lib $fs/usr
			;;
	esac
}
